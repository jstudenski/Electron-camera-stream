<head>
  <link href="style/style.css" rel="stylesheet">
</head>
<body>

<div class="userButtons">

<!--   <div id="addTask" onclick="sendSignal('addTask:btn')">Add Task</div>
  <div id="clear" onclick="clearTodos()">Clear List</div>
  <div id="showfiles" onclick="sendSignal('showfiles:btn')">Show Files</div>
  <div id="transfer" onclick="sendSignal('transfer:btn')">Transfer Pic</div>
  <div id="download" onclick="sendSignal('download:btn')">download</div>
  <div id="upload" onclick="sendSignal('upload:btn')">upload</div>
  <div id="sendText" onclick="sendSignal('sendText:btn')">Send Jeff gif</div> -->

<!--   <br> -->

  <div id="capture" onclick="sendSignal('capture:btn')">Capture</div>
  <div id="sync" onclick="sendSignal('sync:btn')">Sync images</div>
  <div id="test" onclick="sendSignal('test:btn')">Test</div>
  <div id="move" onclick="sendSignal('move:btn')">Move</div>
  <br>
</div><!-- userButtons -->



<br>
<br>
<h1 id="timer" class="timer">00.00</h1>
<br>
<br>



<div id="gallery"></div>

<br>

<div id="keypad-row">
  

  <ul id="keypad">

  <form class="center">
  <label>Phone Number<br>
    <input id="phone-number" type="text" class="write" autofocus>
  </label>
  <button id="submit" type="submit"></button>
  </form>


    <li class="number" value="1">1</li>   
    <li class="number" value="2">2</li>
    <li class="number" value="3">3</li>
    <li class="number" value="4">4</li>
    <li class="number" value="5">5</li>
    <li class="number" value="6">6</li>
    <li class="number" value="7">7</li>
    <li class="number" value="8">8</li>
    <li class="number" value="9">9</li>    
    <li class="delete">del</li>
    <li class="number" value="0">0</li>
  </ul>
</div>


<div id="admin" onclick="sendSignal('admin:btn')"><img src="./images/icons/cog.svg"></div>
<div id="admin-panel">
  <div id="refresh" onclick="sendSignal('refresh:btn')"><img src="./images/icons/refresh.svg"></div>
  <div id="devTools" onclick="sendSignal('devTools:btn')"><img src="./images/icons/magic.svg"></div>
  <div id="manualAdd">
    <form>MGIF<input id="manualAdd-number" type="text" name="number" placeholder="1000">.gif
    <input id="manualAdd-submit" type="submit" value="get"></input></form> 
  </div>
  <div id="showTimer"><img src="./images/icons/clock.svg">
    <p>Toggle Timer</p>
  </div>

    <div id="toggle" class="timer">Start</div>
    <div id="reset" class="timer"><p>Reset</p></div>

</div>




  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" onload="window.$ = window.jQuery = module.exports;"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.10/jquery.mask.js" onload="window.$ = window.jQuery = module.exports;"></script>

  <script src="javascript/keyboard.js"></script>
  <script src="javascript/stopwatch.js"></script>



<script>

  $('.timer').hide();
  $('#showTimer').click(function() {
    $('.timer').toggle();
  });



  var adminPanelOpen = false;
  $("#admin-panel").hide();
  $('.admin-show').hide();


  $("#admin").click(function() {
    if (adminPanelOpen === false) {
      $("#admin-panel").show();
      $('.admin-show').show();
      adminPanelOpen = true;
    } else if (adminPanelOpen === true) {    
      $("#admin-panel").hide();
      $('.admin-show').hide();
      adminPanelOpen = false;
    }
  });










    function showSendBtn() {
      if (phonenumber.length === 10) {
        $('#submit').show();
      } else {
        $('#submit').hide();
      }
    }
    var phonenumber = '';  
    showSendBtn();

    $('#phone-number').mask('(000) 000-0000');


    $( "#phone-number" ).keyup(function() {
     // console.log();
      phonenumber = $("#phone-number").cleanVal()
      console.log(phonenumber);  
      showSendBtn();
    });

    $('.number').click(function(){
      if (phonenumber.length < 10) {
        phonenumber += $(this).attr("value");
        $('#phone-number').val(phonenumber);
        $('#phone-number').trigger('input');
        console.log(phonenumber)
        console.log(phonenumber.length)

      } else {
        console.log(phonenumber);  
      }

      showSendBtn();

    });

    $('.delete').click(function(){
      console.log();
      phonenumber = phonenumber.substring(0,phonenumber.length-1);
      $('#phone-number').val(phonenumber);
      $('#phone-number').trigger('input');
      showSendBtn();
    });


    $('#submit').click(function(event) {
      event.preventDefault();

      // const { value } = document.querySelector('input');
      value = $('input').cleanVal();

      // console.log($('input').cleanVal());
      $('#phone-number').val('');

      ipcRenderer.send('phone:add', value)
    });


    $('#manualAdd-submit').click(function(){  
      event.preventDefault();
      var imgNumber = $('#manualAdd-number').val();
      $('#manualAdd-number').val('');
      console.log(imgNumber);

      ipcRenderer.send('get:image', imgNumber)
    });


 


    // require electron and ipcRenderer
    const electron = require('electron');
    const {ipcRenderer } = electron;
    const list = document.querySelector('ul');
    // listen for todo:add from Electron App
    ipcRenderer.on('todo:add', (event, todo) => {
      const li = document.createElement('li');
      const text = document.createTextNode(todo);
      li.appendChild(text);
      list.appendChild(li);
    });


    // listen for todo:clear from Electron App
    ipcRenderer.on('start:stopwatch', (event, todo) => {
     toggleBtn.textContent = 'Stop';
     watch.start();
    });

    // listen for todo:clear from Electron App
    ipcRenderer.on('stop:stopwatch', (event, todo) => {
     toggleBtn.textContent = 'Start';
     watch.stop();
    });


    // listen for todo:clear from Electron App
    ipcRenderer.on('todo:clear', (event, todo) => {
      clearTodos();
    });


    var files = []
    // listen for showfiles:btn from Electron App
    ipcRenderer.on('showfiles:btn', (event, array) => {
      files = array;

      clearTodos();
      for (var i in array) {
        const li = document.createElement('li');
        const text = document.createTextNode(files[i].filename);
        li.appendChild(text);
        list.appendChild(li);
      }

    });



    // generate gallery
    ipcRenderer.on('list-of-images', (event, list) => {
      // clear gallery
      $('#gallery').html('');

      $.each(list, function( index, url ) {
        // container
        var div = $('<div>');

        div.addClass('gallery-item');
        div.click(isActive);
        // image
        var img = $('<img/>');
        img.attr('src', 'images/gifs/'+url);
       // img.addClass('gallery-item');
        img.appendTo(div);
        // image name

        var btnBar = $('<div>');
        btnBar.addClass('btnBar');
          // remove button
          var remove = $('<div>');
          remove.addClass('remove-button');
          remove.html('<img src="./images/icons/trash.svg">');
          remove.click(removeGif);
          remove.attr('data-url', 'images/gifs/'+url);
          remove.appendTo(btnBar);
          // send button
          var send = $('<div>');
          send.addClass('send-button');
          send.html('Send');
          send.appendTo(btnBar);

        btnBar.appendTo(div);

        var p = $('<p>');
        p.text(url);
        p.addClass('admin-show');
        p.appendTo(div);



        div.appendTo($('#gallery'));

      });


    });


    function isActive() {
      $('.gallery-item').removeClass("isActive");
      $(this).addClass("isActive");
    }


    function removeGif() {
      ipcRenderer.send('remove:image', $(this).attr('data-url'))
    }





    ipcRenderer.on('transfer:btn', (event, todo) => {
      var img = document.createElement("img");
      img.src = "test.jpg";
      document.getElementById("myimg").innerHTML(img);
      document.getElementById("myimg").src="test.jpg";
    });


    // listen for transfer:btn from Electron App
    ipcRenderer.on('transfer:btn', (event, todo) => {

      var img = document.createElement("img");
      img.src = "test.jpg";

      document.getElementById("myimg").innerHTML(img);
      document.getElementById("myimg").src="test.jpg";

    });


    // document.getElementById('clear').addEventListener ('click', (event) => {
    //   clearTodos();
    // });


    function clearTodos() {
      list.innerHTML = '';
    }

    function sendSignal(signal) {
      ipcRenderer.send(signal)
    }



  </script>
</body>